# CSV 文件导入/导出说明

## 导出 CSV 文件

点击"📄 导出记录"按钮后，系统会自动下载 CSV 文件，文件名格式为：`使用记录_YYYY-MM-DD.csv`

**编码方式**：UTF-16 LE（Excel 最佳兼容）

## 如何在 Excel 中正确打开 CSV

### 方法一：直接双击（推荐）

导出的 CSV 文件已经使用 UTF-16 LE 编码，在 Windows 系统中直接双击应该可以正常打开，中文不会乱码。

### 方法二：如果仍然乱码

如果双击打开还是乱码，请使用以下方法：

1. **打开 Excel**
2. 点击"数据" → "自文本/CSV"（或"获取数据" → "来自文件" → "从文本/CSV"）
3. 选择导出的 CSV 文件
4. 在导入向导中：
   - 文件原始格式：选择 **"65001: Unicode (UTF-8)"** 或 **"Unicode"**
   - 分隔符：选择 **"逗号"**
   - 点击"加载"

### 方法三：使用记事本转换

1. 用**记事本**打开 CSV 文件
2. 点击"文件" → "另存为"
3. 编码选择：**"UTF-8"**
4. 保存后用 Excel 打开

## 导入 CSV 文件

### CSV 文件格式

```csv
姓名,物品类型,款式,尺寸,物品名称,数量,备注,时间
张三,衣服,黑,M,,1,日常使用,
李四,其它,,,口罩,10,紧急需要,
王五,衣服,灰蓝,L,,2,,
```

### 字段说明

| 列名     | 必填 | 说明               | 示例     |
| -------- | ---- | ------------------ | -------- |
| 姓名     | ✅   | 使用人姓名         | 张三     |
| 物品类型 | ✅   | 填写"衣服"或"其它" | 衣服     |
| 款式     | ⚠️   | 衣服类型必填       | 黑       |
| 尺寸     | ⚠️   | 衣服类型必填       | M        |
| 物品名称 | ⚠️   | 其它类型必填       | 口罩     |
| 数量     | ✅   | 使用数量           | 1        |
| 备注     | ❌   | 可选               | 日常使用 |
| 时间     | ❌   | 留空自动生成       |          |

### 导入步骤

1. 准备好符合格式的 CSV 文件
2. 点击"📂 导入记录"按钮
3. 选择文件
4. 等待导入完成
5. 查看导入结果（成功/失败数量）

### 常见错误

❌ **姓名或数量为空** → 该行会被跳过  
❌ **衣服类型缺少款式或尺寸** → 导入失败  
❌ **其它类型缺少物品名称** → 导入失败

## 使用技巧

### 1. 批量修改

1. 导出现有记录
2. 用 Excel 打开并编辑
3. 保存为 CSV（UTF-8 或 Unicode）
4. 重新导入

### 2. 模板使用

项目根目录提供了 `usage_template.csv` 模板文件：

```csv
姓名,物品类型,款式,尺寸,物品名称,数量,备注,时间
张三,衣服,黑,M,,1,日常使用,
李四,其它,,,口罩,10,紧急需要,
```

直接复制此模板，修改数据后导入即可。

### 3. Excel 编辑注意事项

- **保存时选择 CSV UTF-8** 格式
- **不要添加额外的列**
- **确保数据类型正确**（数量必须是数字）
- **中文要用中文标点符号**（逗号要用英文 ,）

## 编码问题终极解决方案

如果尝试所有方法后，Excel 打开导出的 CSV 文件仍然乱码：

### 方案一：使用 WPS Office

WPS 对 UTF-8 编码的支持更好，可以直接打开。

### 方案二：使用 Google Sheets

1. 打开 Google Sheets
2. 文件 → 导入 → 上传
3. 选择 CSV 文件
4. 会自动识别编码

### 方案三：使用文本编辑器

使用支持 UTF-8 的文本编辑器（如 VS Code、Notepad++）查看和编辑 CSV。

---

## 常见问题

**Q: 为什么导出的文件 Excel 打开是乱码？**  
A: 已使用 UTF-16 LE 编码，Windows Excel 应该能正确识别。如果仍然乱码，请使用上述"方法二"手动指定编码导入。

**Q: 可以用 Excel 直接编辑导出的 CSV 吗？**  
A: 可以，但保存时请选择"CSV UTF-8"格式。

**Q: 导入时部分记录失败怎么办？**  
A: 检查失败记录是否符合格式要求，特别注意必填字段。

**Q: 时间列需要填写吗？**  
A: 不需要，系统会自动生成当前时间。

---

**技术支持**：查看项目 README.md 获取更多帮助
